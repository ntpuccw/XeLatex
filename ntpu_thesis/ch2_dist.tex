%\include{preamble}
%\title{第2章 \\ 多變量二元聯合機率分配}
%\date{}
%\author{}
%\begin{document}
%\maketitle

\chapter{多變量二元聯合機率分配}\label{ch:dist}
\noindent 本論文以指標 $i$ 代表某研究對象,指標 $t$ 代表某觀察或試驗時間點;並假設重複試驗次數為 $k$ 次,各時間點參與試驗之人數皆為 $n$。
令二元隨機變數 $Y_{it},\,i=1,\ldots,n,\;t=1,\ldots,k,$ 代表第 $i$ 個對象在時間點 $t$ 的試驗結果,
並假設 $Y_{it}$ 之邊際分配為參數 $p_t$ 的白努利分配, $t=1,\ldots,k$, 且不同研究對象間的試驗結果為獨立,但同一研究對象各次試驗結果間可能存在關係。
此外,令 $y_{it}$ 為其所對應的樣本值, $y_{it}=$ 0, 1, 並令
$$\bm{y}_i =\left(
            \begin{array}{c}
             y_{i1} \\
             y_{i2} \\
             \vdots \\
             y_{ik}
            \end{array} \right),$$
為一個 $k \times 1$ 的向量,表示第 $i$ 個試驗對象 $k$ 次試驗結果。
於論文中若未重新進行符號定義,在不造成閱讀困擾的前提下,將以 $Y_t$ 表示第 $i$ 個對象在時間點 $t$ 的試驗結果,以簡化符號。
本章將先說明成對資料之聯合機率函數的建構概念,之後再將此方法一般化,提出新的多變量二元資料的聯合機率函數。

\section{多變量聯合機率質量函數}
\noindent 本論文假設 $\{Y_t,1\leq t \leq k\}$ 為一階馬可夫鏈(First-Order Markov Chains),亦即時間 $t+1$ 的狀態僅與時間 $t$ 有關;
利用 Biswas 和 Hwang (2002) 提出的條件機率公式定義時間 $t$ 與 $t+1$ 間診斷試驗結果的條件機率,提出隨機變數 $Y_1,\ldots,Y_k$ 之JPMF如下:
\begin{align}\label{equ:jpmf}
    f(y_1,\cdots,y_k) &=f(y_1)f(y_2|y_1)f(y_3|y_1,y_2) \cdots f(y_k|y_1,\ldots y_{k-1}) \notag\\
                      &=f(y_1)f(y_2|y_1)f(y_3|y_2) \cdots f(y_k|y_{k-1}) \notag\\
                      &=p_1^{y_1} (1-p_1)^{1-y_1} (\mbox{P}^{12}_{y_1,1})^{y_2} (1-\mbox{P}^{12}_{y_1,1})^{1-y_2} (\mbox{P}^{23}_{y_2,1})^{y_3} (1-\mbox{P}^{23}_{y_2,1})^{1-y_3} \notag\\
                      &\quad \times \cdots \times (\mbox{P}^{k-1,k}_{y_{k-1},1})^{y_k} (1-\mbox{P}^{k-1,k}_{y_{k-1},1})^{1-y_k} \notag\\
                      &= p_1^{y_1} (1-p_1)^{1-y_1} \, \prod_{t=1}^{k-1} \, (\mbox{P}^{t,t+1}_{y_t,1})^{y_{t+1}} \, (1-\mbox{P}^{t,t+1}_{y_t,1})^{1-y_{t+1}}
\end{align}
在此函數假設下，任意兩時間點 $Y_t=1$ 與 $Y_u=1$ 的聯合機率跟時間點 $t$ 的變異數有關,關係式如引理~ \ref{lem:lem1} ，此證明請參考附錄 A; 而由引理~ \ref{lem:lem1}，可證明出任意兩時間點診斷試驗結果的共變異數如定理~ \ref{thm:cov}。
\begin{lemma}\label{lem:lem1}
假設 $\sigma_t^2$ 為診斷試驗結果 $Y_t$ 的變異數,則任意兩時間點 $Y_t$ 與 $Y_u$ 事件皆發生的機率為
$$\mbox{\textup{Pr}}(Y_t=1,Y_u=1)=p_t p_u + \sigma_t^2 \, \prod_{m=t}^{u-1} \frac{\alpha_{m,m+1}}{1+\alpha_{m,m+1}},\;\;\forall\; 1\leq t<u \leq k$$
\end{lemma}

\begin{thm}\label{thm:cov}
假設 $\sigma_t^2$ 為診斷試驗結果 $Y_t$ 的變異數,則任意兩時間點 $Y_t$ 與 $Y_u$ 的共變異數為
$$\mbox{\textup{Cov}}(Y_t,Y_u)=\sigma_t^2 \, \prod_{m=t}^{u-1} \frac{\alpha_{m,m+1}}{1+\alpha_{m,m+1}} , \;\;\;\;\forall\; 1\leq t<u \leq k$$
\end{thm}

\begin{proof}

由共變異數之定義可得
\begin{align*}
  \mbox{\textup{Cov}}(Y_t,Y_u) &= \mbox{\textup{E}}(Y_t Y_u)-\mbox{\textup{E}}(Y_t)\mbox{\textup{E}}(Y_u) \\
                      &= \sum_{y_t}\sum_{y_u}\; y_t y_u f(y_t,y_u)-p_t p_u \\
                      &= \mbox{Pr}(Y_t=1,Y_u=1) - p_t p_u \\
                      &= p_t p_u + \sigma_t^2 \, \prod_{m=t}^{u-1} \frac{\alpha_{m,m+1}}{1+\alpha_{m,m+1}}  - p_t p_u \\
                      &= \sigma_t^2 \, \prod_{m=t}^{u-1} \frac{\alpha_{m,m+1}}{1+\alpha_{m,m+1}}
\end{align*}
\end{proof}


%\end{document}

